# OpenAPI generated FastAPI server

This Python package is automatically generated by the [OpenAPI Generator](https://openapi-generator.tech) project:

- API version: 1.0.0
- Build package: org.openapitools.codegen.languages.PythonFastAPIServerCodegen

## Requirements.

Python >= 3.7

## Installation & Usage

To run the server, please execute the following from the root directory:

```bash
pip3 install -r requirements.txt
uvicorn main:app --host 0.0.0.0 --port 8080
```

and open your browser at `http://localhost:8080/docs/` to see the docs.

## Running with Docker

To run the server on a Docker container, please execute the following from the root directory:

```bash
docker-compose up --build
```

## Running with kubernetes

1. Install and configure minikube  
```bash
brew install minikube
minikube start --vm=true --driver=hyperkit
```
1. Install: helm 3, kubectl
```bash
brew install helm
brew install kubectl
```
2. **(Optional)** Build docker image and load it in minikube
```bash
docker build -t otus-homework-6 .
minikube image load otus-homework-6:latest --daemon=true --overwrite=true
```
3. Install ingress
```bash
helm upgrade --install ingress-nginx ingress-nginx \
  --repo https://kubernetes.github.io/ingress-nginx \
  --namespace ingress-nginx --create-namespace \
  --set controller.service.externalIPs={$(minikube ip)}
```
4. Helm install command  
```bash
cd helm/homework-6
kubectl config set-context minikube
helm repo add postgresql https://cetic.github.io/helm-charts
helm dependency build
helm upgrade otus-homework-6 ./ --install --wait
```
5. Configure `/etc/hosts`
```bash
echo "$(kubectl get ing otus-homework-6 -o jsonpath='{.status.loadBalancer.ingress[0].ip}') arch.homework" | sudo tee -a /etc/hosts
```
6. Check using postman collection in file `User Service.postman_collection.json`




